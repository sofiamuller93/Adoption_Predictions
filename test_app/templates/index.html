<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Rick</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.5.0/d3.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body>
    <div id="plotAge"></div>
    <div id="plotColor"></div>

    {% for pet in data %}
        <h2 id="breed{{pet.id}}">{{pet.breed}}</h2>
        <div id="plot{{pet.id}}"></div>
        <div id=plotgender{{pet.id}}></div>
    {% endfor %}

    <script>

    // var breed = "Pit Bull Mix" 
    // d3.json('/data/' + breed).then(function(data) {
    //     console.log(data);

    //     var trace = {
    //         x: data.age_range,
    //         type: 'histogram',
    //     };
    //     var data = [trace];
    //     Plotly.newPlot('plotAge', data);

    // });

    function buildPlot(breed, id) {

            d3.json('/data/' + breed).then(function (data) {

                console.log(data);
                var trace1 = {
                    x: data.x,
                    y: data.y,
                    type: "bar"
                };

                var data = [trace1];

                var layout = {
                    title: data.title
                };

                Plotly.newPlot("plot"+id, data, layout);

            });
        }

    function buildgenderPlot(breed, id) {

            d3.json('/gender/' + breed).then(function (data) {

                console.log(data);
                var trace1 = {
                    x: data.x,
                    y: data.y,
                    type: "bar"
                };


                var data = [trace1];

                var layout = {
                    title: data.title
                };

                Plotly.newPlot("plotgender"+id, data, layout);

            });
            }
        
    var breed1 = d3.select("#breed1").text()
    buildPlot(breed1, 1)

    var breed2 = d3.select("#breed2").text()
    buildPlot(breed2, 2)

    
    buildgenderPlot(breed1, 1)

    </script>

</body>

</html>